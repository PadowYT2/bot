"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.run=exports.permission=exports.options=void 0;const builders_1=require("@discordjs/builders");exports.options=(new builders_1.SlashCommandBuilder).setName("purge").setDescription("Удалить указанное количество сообщений в канале.").addIntegerOption((e=>e.setName("amount").setDescription("Количество сообщений которое надо удалить.").setRequired(!0).setMinValue(2).setMaxValue(100))).addUserOption((e=>e.setName("member").setDescription("Участник, чьи сообщения должны быть очищены."))).toJSON(),exports.permission=1;const cooldowns=new Set,database_1=__importDefault(require("../database/")),run=async e=>{if("DM"==e.channel.type)return;if(cooldowns.has(e.channel.id))return await e.reply({content:"❌ Подождите несколько секунд перед повторным использованем команды.",ephemeral:!0});cooldowns.add(e.channel.id)&&setTimeout((()=>cooldowns.delete(e.channel.id)),3500);const t=await database_1.default.settings(e.guild.id);if(!e.channel.permissionsFor(e.guild.me).has("MANAGE_MESSAGES"))return await e.reply({content:"❌ У меня нет прав на управление сообщениями в этом канале.",ephemeral:!0});const s=e.options.getInteger("amount");let i=await e.channel.messages.fetch({limit:s});if(t.get().purgePinned||(i=i.filter((e=>!e.pinned))),e.options.getUser("member")&&(i=i.filter((t=>t.author.id==e.options.getUser("member").id))),!i.size)return await e.reply({content:"❌ Не удалось найти сообщений для удаления.",ephemeral:!0});const n=await e.channel.bulkDelete(i,!0);await e.reply({content:n.size?"✅ Удалено "+(1==n.size?n.size+" сообщение":[2,3,4].includes(n.size)?n.size+" сообщения":n.size+" сообщений"):"Произошла ошибка при подсчёте удалённых сообщений."})};exports.run=run;