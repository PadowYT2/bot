"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};const constants_1=require("../constants/"),database_1=__importDefault(require("../database/"));module.exports=t=>Promise.all(t.guilds.cache.map((async a=>{const e=await database_1.default.guild(a.id),{liveboard:{channel:s,message:n},users:i}=e.get();if(s&&n){const a=await t.channels.fetch(s).catch((()=>null));if(!a)return;const e=await a.messages.fetch(n).catch((()=>null));if(!e)return;const c=Object.keys(i).sort(((t,a)=>i[a]-i[t])).slice(0,25).map(((t,a)=>(0,constants_1.formatScore)(t,a,i,e.author.id))).join("\n");await e.edit({content:null,embeds:[{author:{name:`Лидеры ${e.guild.name}`,icon_url:e.guild.iconURL({dynamic:!0})},description:c,timestamp:Date.now()}]}).catch((()=>null))}})));