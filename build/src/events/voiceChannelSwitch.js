"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.run=void 0;const Util_1=__importDefault(require("../util/Util"));async function run(e,t,i){const a=await Util_1.default.database.settings(e.guild.id),{voices:l}=a.get(),s=await Util_1.default.database.guild(e.guild.id);s.get().voices[t.id]===e.user.id&&(await t.delete().catch((()=>null)),s.removeFromObject("voices",t.id)),l.lobby===i.id&&l.enabled&&await e.guild.channels.create("Комната "+e.user.tag,{type:"GUILD_VOICE",parent:i.parentId,permissionOverwrites:[{id:e.user.id,allow:["MANAGE_CHANNELS","PRIORITY_SPEAKER","STREAM"]}]}).then((async t=>await e.voice.setChannel(t.id).then((()=>s.setOnObject("voices",t.id,e.user.id))).catch((()=>t.delete().catch((()=>null)))))).catch((()=>null))}exports.run=run;